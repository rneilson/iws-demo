<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width">
		<link rel="stylesheet" type="text/css" href="webview.css">
		<link rel="canonical" href="">
		<link rel="alternate" type="application/rss+xml" title="" href="">
		<script type="text/javascript" src="angular.min.js"></script>
		<script type="text/javascript" src="webview.js"></script>
		<title>IWS Demo Webview</title>
	</head>
	<body ng-app="iws-webview">
		<div id="outer" class="noborder nopadding">
			<div id="header" class="header" ng-controller="HeaderController as hdcon">
				<div class="nopadding noborder topleft"><h1>IWS Demo</h1></div>
				<div class="nopadding noborder topright">
					<span ng-class="{hidden: !hdcon.auth.logged_in}">
						<strong>{{hdcon.auth.full_name}}</strong> / <a ng-click="hdcon.logout()">Log out</a>
					</span>
				</div>
				<div class="footer"></div>
			</div>
			<div id="main" class="noborder nopadding" ng-controller="ClientListController as clcon">
				<div id="sidebar" class="leftside nopadding noborder" ng-if="clcon.logged_in">
					<div id="clientlist" class="nopadding noborder">
						<div class="header perchheader">Client list</div>
						<div class="clienttable">
							<table>
								<colgroup>
									<col class="clientname"></col>
									<col class="count"></col>
									<col class="count"></col>
								</colgroup>
								<thead>
									<tr>
										<th>Name</th><th>Open</th><th>Closed</th>
									</tr>
								</thead>
								<tbody>
									<tr ng-class="{selected: cli.id == clcon.clients.id}" ng-repeat="cli in clcon.clients.list" ng-click="clcon.selectclient(cli.id)">
										<td>{{cli.name}}</td><td>{{cli.open_count}}</td><td>{{cli.closed_count}}</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
					<div id="clientdetails" ng-controller="ClientDetailController as cdcon" ng-class="{hidden: !cdcon.client.id}">
						<p><span class="sectitle">{{cdcon.client.name}}</span></p>
						<p>Contact name:<br/>{{cdcon.client.con_name}}</p>
						<p>Contact email:<br/><a href="mailto:{{cdcon.client.con_mail}}">{{cdcon.client.con_mail}}</a></p>
						<p>Date added:<br/>{{cdcon.client.date_add | date:'EEE dd MMM yy'}}</p>
					</div>
				</div>
				<div id="container" class="rightside" ng-controller="ReqListController as rlcon" ng-if="clcon.logged_in">
					<div id="nav">
						<div class="tabnav" ng-class="{selected: rlcon.tab=='open'}" ng-click="rlcon.selecttab('open')">Open requests
						</div><div class="tabnav" ng-class="{selected: rlcon.tab=='closed'}" ng-click="rlcon.selecttab('closed')">Closed requests</div>
					</div>
					<div id="clientopen" class="panel" ng-class="{open: rlcon.tab == 'open'}">
						<table>
							<thead>
								<tr>
									<th class="count">Priority</th>
									<th class="reqtitle">Title</th>
									<th class="short">Area</th>
									<th class="date">Target Date</th>
									<th class="date">Open Date</th>
									<th class="user">Opened By</th>
								</tr>
							</thead>
							<tbody>
								<tr ng-repeat="oreq in rlcon.client.open_list" ng-class="{selected: oreq.req.id == rlcon.req.open}" ng-click="rlcon.selectreq(oreq.req.id)">
									<td class="count">{{oreq.priority}}</td>
									<td class="reqtitle">{{oreq.req.title}}</td>
									<td class="short">{{oreq.req.prod_area}}</td>
									<td class="date">{{oreq.date_tgt | date:'EEE dd MMM yy'}}</td>
									<td class="date">{{oreq.opened_at | date:'EEE dd MMM yy'}}</td>
									<td class="user">{{oreq.opened_by}}</td>
								</tr>
							</tbody>
						</table>
					</div>
					<div id="clientclosed" class="panel" ng-class="{open: rlcon.tab == 'closed'}">
						<table>
							<thead>
								<tr>
									<th class="short">Status</th>
									<th class="reqtitle">Title</th>
									<th class="short">Area</th>
									<th class="date">Target Date</th>
									<th class="date">Closed On</th>
									<th class="user">Closed By</th>
									<th class="date">Opened On</th>
									<th class="user">Opened By</th>
								</tr>
							</thead>
							<tbody>
								<tr ng-repeat="creq in rlcon.client.closed_list" ng-class="{selected: creq.req.id == rlcon.req.closed}" ng-click="rlcon.selectreq(creq.req.id)">
									<td class="short">{{creq.status}}</td>
									<td class="reqtitle">{{creq.req.title}}</td>
									<td class="short">{{creq.req.prod_area}}</td>
									<td class="date">{{creq.date_tgt | date:'EEE dd MMM yy'}}</td>
									<td class="date">{{creq.closed_at | date:'EEE dd MMM yy'}}</td>
									<td class="user">{{creq.closed_by}}</td>
									<td class="date">{{creq.opened_at | date:'EEE dd MMM yy'}}</td>
									<td class="user">{{creq.opened_by}}</td>
								</tr>
							</tbody>
						</table>
					</div>
					<div id="reqdetails" ng-controller="ReqDetailController as rdcon" ng-class="{hidden: !rdcon.req.id}">
						<div class="noborder">
							<p><span class="sectitle">{{rdcon.req.title}}</span></p>
							<p>
								Product Area: <strong>{{rdcon.req.prod_area}}</strong><br/>
								Reference: <a href="{{rdcon.req.ref_url}}">{{rdcon.req.ref_url}}</a>
							</p>Description:<br/><pre class="desc">{{rdcon.req.desc}}</pre>
						</div>
					</div>
				</div>
				<div id="footer", class="footer"></div>
			</div>
			<div id="login" ng-class="{hidden: lgcon.auth.logged_in}" ng-controller="LoginController as lgcon">
				<div id="login-msg" class="header">
					{{lgcon.login_msg}}
				</div>
				<div id="login-form" ng-class="{hidden: !lgcon.login_req}">
					<form name="lgcon.login_form" novalidate>
						<div class="form-row">
						  <label for="id_username">Username:
						  </label><input id="id_username" maxlength="254" name="username" type="text" ng-model="lgcon.username" required/>
						</div>
						<div class="form-row">
						  <label for="id_password">Password:
						  </label><input id="id_password" name="password" type="password" ng-model="lgcon.password" required/>
						</div>
						<div class="submit-row">
							<input type="submit" value="Log in" ng-click="lgcon.login()"/>
						</div>
					</form>
				</div>
			</div>
		</div>
	</body>
</html>
